<!DOCTYPE html> 
<html>
<head>
<meta charset="utf-8">
<title>Aplic. Web de jQuery Mobile</title>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
<link href="jquery-mobile/jquery.mobile-1.0.min.css" rel="stylesheet" type="text/css"/>
<link href="style/estilos.css" rel="stylesheet" type="text/css"/>
<script src="jquery-mobile/jquery-1.7.2.min.js" type="text/javascript"></script>
<script src="jquery-mobile/AjaxUpload.2.0.min.js"></script>
<script src="jquery-mobile/jquery-1.6.4.min.js" type="text/javascript"></script>
<script src="jquery-mobile/jquery.mobile-1.0.min.js" type="text/javascript"></script>
<script src="jquery-mobile/scripts.js"></script>
</head> 
<script>
				function getGPS(){
					//alert("hola  acceso");
					if(navigator.geolocation){
						navigator.geolocation.getCurrentPosition(showGPS,gpsError);
						}else{
						
							alert("No funciona  el gps")
						}
					}
				function gpsError(error){
						alert("No funcion el gps");
						//alert("GPS ERROR:"+error.code+","+error.message);
					}
				function showGPS(position){
					var lat=position.coords.latitude;
					var long=position.coords.longitude;
					alert(lat+"--"+long);
					google.maps.event.addDomListener(window, 'load', initialize2);
					} 	
					//getGPS();
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
				/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
				
						function initialize2(){
							alert();
								initialize('4.7214847','-74.0567932')
						}
						// VARIABLES GLOBALES JAVASCRIPT
						var geocoder;
						var marker;
						var latLng;
						var latLng2;
						var map;
						// INICiALIZACION DE MAPA
						function initialize(_lat2,_lng2) {
								geocoder = new google.maps.Geocoder();	
								//SE CREA EL CENTRO  DONDE SE  UBICARA EL MARCADOR  A PARTIR DE LA LONGITUD Y LATITUD  OPTENIDA DE LAS VARIABLE POST  ENVIADAS POR ELFORMULARIO 
								latLng = new google.maps.LatLng(_lat2,_lng2);
								//alert(latLng)  
								//ES EL DIV  DONDE  SE MOSTRARA EL MAPA, ESTE DIV  TIENE  UN ANCHO Y ALTO DEFINIDO
								map = new google.maps.Map(document.getElementById('mi_mapa'), {
								zoom:20,
								center: latLng,
								mapTypeId: google.maps.MapTypeId.ROADMAP
								});
								//AGREGA  UN DOCUMENTO  KML SUDIBO EN UN SERVIDOR  EN ESTE CASO SESUBIO EN UN SITIO PROPIO DE GMIAL CREADO ATRAVES DE UNA CUENTA  EN ESTE CASO LA PERSONAL
								var ctaLayer = new google.maps.KmlLayer({
								url: "http://www.edisyst.com/georef/labrasacbc.kml"
								});
								ctaLayer.setMap(map);
								// CREACION DEL MARCADOR  EL GLOBITO ROJO QUE NOS INDICA DONDE DA EL CENTRO DE LAS COORDENADAS DADAS
								marker = new google.maps.Marker({
								position: latLng,
								title: 'No Se Puede Arrastrar',
								map: map,
								draggable: false
								});
						}
						// Permito la gesti¢n de los eventos DOM, INICIALIZA LA FUCNION

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
$(document).ready(function(){
    var button = $('#upload_button'), interval;
    new AjaxUpload('#upload_button', {
        action: 'http://juanrodriguezg.site90.com/webservices/uploadFile.php?jsoncallback=?',
        onSubmit : function(file , ext){
        if (! (ext && /^(jpg|png|jpeg|gif)$/.test(ext))){
            // extensiones permitidas
            alert('Error: Solo se permiten imagenes');
            // cancela upload
            return false;
        } else {
                      // Cambio el texto del boton y lo deshabilito
            button.text('Cargando  imagen');
            this.disable();
        }
        },
        onComplete: function(file, response){
            button.text('Upload  imagen  exitosamente');
            // habilito upload button       
			respuesta = $.parseJSON(response);               
					if(respuesta.respuesta == 'done'){
						alert("LA IMAGEN SE SUBIO EXITOSAMENTE");
						$('#fotografia').removeAttr('scr');
						$('#fotografia').attr('src','http://juanrodriguezg.site90.com/img/' + respuesta.fileName);
						$('#loaderAjax').show();
						// alert(respuesta.mensaje);
					}
					else{
						alert(respuesta.mensaje);
					}
					$('#loaderAjax').hide();	
					this.enable();	
        }  
    });
});
</script>
<body> 
<div data-role="page" id="inicio">
    <div data-role="header" style="background-color:#09F">
        	<h1>Autenticacion</h1>
    </div>
    <div data-role="content"  id="guardar">	
        <form id="formulario">
        <center>
        <!--<img src="img/login.png" width="50" height="50" >-->
        </center>
        <br>
        <label> Usuario </label>
        <input type="text" id="nombredeusuario" name="nombredeusuario">
        <label> Password </label>
        <input type="password" id="clave" name="clave">
        <input type="submit" value="Login" id="botonLogin">
        </form>	
    </div>
</div>

 <div data-role="page" id="menu">
 <div data-role="header">
 <center>
      Usuario:<span id="nombre_usuario"  style="font-size:12px"></span>
 </center>
 </div>     
      <div data-role="content"  id="menu">	
            <input  type="button"  value="Consultar"  id="botton_buscar" >
            <input  type="button"  value="Guardar"  id="botton_guardar" >
            <input  type="button"  value="Eliminar"  id="botton_eliminar">
            <input  type="button"  value="Editar"  id="botton_editar" >
            <input  type="button"  value="Subir foto"  id="botton_subir_foto" >
            <input  type="button"  value="Ver mapa"  id="botton_ver_mapa" >
            <input  type="button"  value="Salir"  id="botton_salir" >
      </div>
</div>


<div data-role="page" id="menu_guardar">
     <div data-role="header">
     <center>
          Usuario:<span id="nombre_usuario2"  style="font-size:12px"></span>
     </center>
     </div>        
     <div data-role="content">	
   			<table border="0"  width="100%"
            <tr>
            <td>
            Nombre
            </td>
            <td>
            <input  type="text"  value=""  id="dato1">
            </td>
            </tr>
            <tr>
            <td>
            Apellido
            </td>
            <td>
            <input  type="text"  value=""  id="dato2">
            </td>
            </tr>
            <tr>
            <td>
            Sexo
            </td>
            <td>
            <select  id="sexo"  name="sexo">
            <option>M</option>
            <option>F</option>
            </select>
            </td>
            </tr>
            <tr>
            <td>
            Ciudad
            </td>
            <td>
     		 <select id="select11"  name="select11">
            <option value="0">Seleccione</option> 
            </select>
            </td>
            </tr>
            <tr>
            <td style="width:50%">
            <input  type="button"  value="Guardar"  id="botton_agregar" >
     		</td>
            <td style="width:50%">
            <input  type="button"  value="Volver"  id="botton_volver" >
            </td>
            </tr>
            </table>
     </div>
</div>

<div data-role="page" id="menu_consultar">
     <div data-role="header">
     <center>
          Usuario:<span id="nombre_usuario22"  style="font-size:12px"></span>
     </center>
     </div>        
     
     <input  type="button"  value="Buscar"  id="botton_buscar_datos" >
   		<div  id="tabla_busqueda" style="width:100%"></div>
     
</div>

<div data-role="page" id="menu_subir_foto">
     <div data-role="header">
     <center>
          Usuario:<span id="nombre_usuario22"  style="font-size:12px"></span>
     </center>
     </div>        
     <div data-role="content">	     
                    <div id="upload_button">Upload</div>               
                    	    	<div id="contenedorImagen">
	    						<img id="fotografia" class="fotografia" src="http://juanrodriguezg.site90.com/img/nofoto.jpg">
	    						</div>
                                <div class="loaderAjax" id="loaderAjax">
                                <img src="http://juanrodriguezg.site90.com/img/default-loader.gif">
                                <span>Publicando Fotografía...</span>
                                </div>
     </div>
</div>
<!-- /////////////////MAPA/////////////////// -->
<div data-role="page" id="menu_mapa">
     <div data-role="header">
     <center>
          Usuario:<span id="nombre_usuario22"  style="font-size:12px"></span>
     </center>
     </div>        
     <div data-role="content">	     
			<input  type="button"  value="ver_mapa"  onClick="getGPS()">
            <div id="mi_mapa" style="width:100%;height:100%; background-color:#dddada;float:right;">   
			</div>
     </div>
</div>
</body>
</html>
